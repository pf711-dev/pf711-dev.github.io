<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GA æµ‹è¯• - ç®€åŒ–ç‰ˆ</title>
    
    <!-- Google Analytics 4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-S7VJCRNLF6"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        
        console.log('ğŸš€ å¼€å§‹åŠ è½½ Google Analytics...');
        
        gtag('config', 'G-S7VJCRNLF6', {
            debug_mode: true,
            send_page_view: true
        });
        
        console.log('âœ… Google Analytics é…ç½®å®Œæˆ');
        
        // æ£€æŸ¥ gtag æ˜¯å¦å¯ç”¨
        setTimeout(() => {
            if (typeof gtag === 'function') {
                console.log('âœ… gtag å‡½æ•°å¯ç”¨');
                console.log('ğŸ“‹ dataLayer:', window.dataLayer);
                
                // å‘é€æµ‹è¯•äº‹ä»¶
                gtag('event', 'test_page_load', {
                    event_category: 'test',
                    event_label: 'manual_test',
                    value: 1
                });
                console.log('ğŸ“¤ æµ‹è¯•äº‹ä»¶å·²å‘é€');
            } else {
                console.error('âŒ gtag å‡½æ•°ä¸å¯ç”¨');
            }
        }, 2000);
    </script>
</head>
<body>
    <h1>Google Analytics æµ‹è¯•é¡µé¢</h1>
    <p>è¿™æ˜¯ä¸€ä¸ªç®€åŒ–çš„æµ‹è¯•é¡µé¢ï¼Œç”¨äºéªŒè¯ Google Analytics æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚</p>
    
    <div style="margin: 20px 0;">
        <button onclick="sendCustomEvent()">å‘é€è‡ªå®šä¹‰äº‹ä»¶</button>
        <button onclick="checkGA()">æ£€æŸ¥ GA çŠ¶æ€</button>
    </div>
    
    <div id="status" style="margin-top: 20px; padding: 10px; background: #f0f0f0; border-radius: 5px;">
        <h3>çŠ¶æ€ä¿¡æ¯ï¼š</h3>
        <div id="statusContent">æ­£åœ¨æ£€æŸ¥...</div>
    </div>
    
    <script>
        function sendCustomEvent() {
            if (typeof gtag === 'function') {
                gtag('event', 'button_click', {
                    event_category: 'engagement',
                    event_label: 'custom_test_button',
                    value: 1
                });
                console.log('ğŸ¯ è‡ªå®šä¹‰äº‹ä»¶å·²å‘é€');
                updateStatus('âœ… è‡ªå®šä¹‰äº‹ä»¶å·²å‘é€');
            } else {
                console.error('âŒ gtag ä¸å¯ç”¨');
                updateStatus('âŒ gtag ä¸å¯ç”¨');
            }
        }
        
        function checkGA() {
            const status = [];
            
            // æ£€æŸ¥ gtag å‡½æ•°
            if (typeof gtag === 'function') {
                status.push('âœ… gtag å‡½æ•°ï¼šå¯ç”¨');
            } else {
                status.push('âŒ gtag å‡½æ•°ï¼šä¸å¯ç”¨');
            }
            
            // æ£€æŸ¥ dataLayer
            if (window.dataLayer && window.dataLayer.length > 0) {
                status.push(`âœ… dataLayerï¼šå·²åˆå§‹åŒ– (${window.dataLayer.length} é¡¹)`);
            } else {
                status.push('âŒ dataLayerï¼šæœªåˆå§‹åŒ–æˆ–ä¸ºç©º');
            }
            
            // æ£€æŸ¥ GA è„šæœ¬
            const gaScript = document.querySelector('script[src*="googletagmanager.com"]');
            if (gaScript) {
                status.push('âœ… GA è„šæœ¬ï¼šå·²åŠ è½½');
            } else {
                status.push('âŒ GA è„šæœ¬ï¼šæœªæ‰¾åˆ°');
            }
            
            updateStatus(status.join('<br>'));
            console.log('ğŸ“Š GA çŠ¶æ€æ£€æŸ¥å®Œæˆ:', status);
        }
        
        function updateStatus(message) {
            document.getElementById('statusContent').innerHTML = message;
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨æ£€æŸ¥
        window.addEventListener('load', () => {
            setTimeout(checkGA, 3000);
        });
    </script>
</body>
</html>